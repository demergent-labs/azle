name: Commit and Push Changes
description: 'Commits and pushes changes using GraphQL for App-signed commits'

inputs:
    branch-name:
        description: 'Name of the branch to push to'
        required: true
    create-branch:
        description: 'Whether to create the branch if it does not exist'
        required: false
        default: 'false'
    commit-message:
        description: 'Commit message'
        required: true
    add-files:
        description: 'File pattern to git add. Defaults to "--all"'
        required: false
        default: '--all'
    token:
        description: 'GitHub App token with repo access'
        required: true

runs:
    using: composite
    steps:
        - name: Commit via GraphQL Script
          shell: bash
          env:
              GITHUB_TOKEN: ${{ inputs.token }}
              BRANCH_NAME: ${{ inputs.branch-name }}
              CREATE_BRANCH: ${{ inputs.create-branch }}
              COMMIT_MESSAGE: ${{ inputs.commit-message }}
              ADD_FILES: ${{ inputs.add-files }}
          run: ./.github/actions/commit_and_push/run.sh
