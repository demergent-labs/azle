name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€
on: [push]
jobs:
    make-new-output:
        runs-on: ubuntu-latest
        outputs:
            all_tests: ${{ steps.get_all_tests.outputs.all_tests }}
        steps:
            - uses: actions/checkout@v4
            - name: Generate Tests
              id: get_all_tests
              run: |
                  all_tests=$(./.github/scripts/generate_tests.sh | base64 -d)
                  echo "all_tests=${all_tests}" >> "$GITHUB_OUTPUT"
    make-old-output:
        name: Generate Tests Old Way
        runs-on: ubuntu-latest
        outputs:
            all_tests: ${{ steps.get_all_tests.outputs.all_tests }}
        steps:
            - uses: actions/checkout@v4
            - name: Generate Tests
              id: get_all_tests
              run: echo "::set-output name=all_tests::$(./.github/scripts/generate_tests.sh | base64 -d)"
    run-test-new:
        name: 'NEW ${{matrix.tests.name}} | ${{matrix.tests.type}} | ${{matrix.tests.syntax}} | ${{matrix.tests.api}}'
        needs:
            - make-new-output
        runs-on: ${{ matrix.os }}
        strategy:
            matrix:
                os: [ubuntu-latest]
                tests: ${{ fromJSON(needs.make-new-output.outputs.all_tests) || fromJSON('["dummy"]') }}
        steps:
            - name: Report full path of test
              run: echo ${{matrix.tests.path}}
    run-test-old:
        name: 'OLD ${{matrix.tests.name}} | ${{matrix.tests.type}} | ${{matrix.tests.syntax}} | ${{matrix.tests.api}}'
        needs:
            - make-old-output
        runs-on: ${{ matrix.os }}
        strategy:
            matrix:
                os: [ubuntu-latest]
                tests: ${{ fromJSON(needs.make-old-output.outputs.all_tests) || fromJSON('["dummy"]') }}
        steps:
            - name: Report full path of test
              run: echo ${{matrix.tests.path}}
