name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions 🚀
on: [push]
jobs:
    Explore-GitHub-Actions:
        runs-on: ubuntu-latest
        steps:
            - run: echo "🎉 The job was automatically triggered by a ${{ github.event_name }} event."
            - run: echo "🐧 This job is now running on a ${{ runner.os }} server hosted by GitHub!"
            - run: echo "🔎 The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
            - name: Check out repository code
              uses: actions/checkout@v4
            - run: echo "💡 The ${{ github.repository }} repository has been cloned to the runner."
            - run: echo "🖥️ The workflow is now ready to test your code on the runner."
            - name: List files in the repository
              run: |
                  ls ${{ github.workspace }}
            - run: echo "🍏 This job's status is ${{ job.status }}."
    make-output:
        runs-on: ubuntu-latest
        outputs:
            output_1: ${{ steps.gen_output.outputs.output_1 }}
            output_2: ${{ steps.gen_output.outputs.output_2 }}
            output_3: ${{ steps.gen_output.outputs.output_3 }}
            all_tests: ${{ steps.gen_tests.outputs.all_tests }}
        strategy:
            matrix:
                version: [1, 2, 3]
        steps:
            - uses: actions/checkout@v4
            - name: Generate output
              id: gen_output
              run: |
                  version="${{ matrix.version }}"
                  echo "output_${version}=${version}" >> "$GITHUB_OUTPUT"
            - name: Generate tests
              id: gen_tests
              run: |
                  version="$(./.github/scripts/generate_tests.sh | base64 -d)"
                  echo "all_tests=${version}" >> "$GITHUB_OUTPUT"
    use-output:
        runs-on: ubuntu-latest
        needs: [make-output]
        steps:
            # Will show
            # {
            #   "output_1": "1",
            #   "output_2": "2",
            #   "output_3": "3"
            # }
            - run: echo '${{ toJSON(needs.make-output.outputs) }}'
            - run: echo '${{ toJSON(needs.make-output.outputs.all_tests) }}'
