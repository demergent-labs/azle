<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Debugging - The Azle Book</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Azle Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="debugging-tldr"><a class="header" href="#debugging-tldr">Debugging TL;DR</a></h1>
<p>If your terminal logs ever say <code>did not produce a response</code> or <code>response failed classification=Status code: 502 Bad Gateway</code>, it most likely means that your canister has thrown an error and halted execution for that call. Use <code>console.log</code> and <code>try/catch</code> liberally to track down problems and reveal error information. If your error logs do not have useful messages, use <code>try/catch</code> with a <code>console.log</code> of the catch error argument to reveal the underlying error message.</p>
<h1 id="debugging"><a class="header" href="#debugging">Debugging</a></h1>
<ul>
<li><a href="#consolelog-and-trycatch">console.log and try/catch</a></li>
<li><a href="#canister-did-not-produce-a-response">Canister did not produce a response</a></li>
<li><a href="#no-error-message">No error message</a></li>
<li><a href="#final-compiled-and-bundled-javascript">Final Compiled and Bundled JavaScript</a></li>
</ul>
<p>Azle currently has less-than-elegant error reporting. We hope to improve this significantly in the future.</p>
<p>In the meantime, consider the following tips when trying to debug your application.</p>
<h2 id="consolelog-and-trycatch"><a class="header" href="#consolelog-and-trycatch">console.log and try/catch</a></h2>
<p>At the highest level, the most important tip is this: use <code>console.log</code> and <code>try/catch</code> liberally to track down problems and reveal error information.</p>
<h2 id="canister-did-not-produce-a-response"><a class="header" href="#canister-did-not-produce-a-response">Canister did not produce a response</a></h2>
<p>If you ever see an error that looks like this:</p>
<pre><code>Replica Error: reject code CanisterError, reject message IC0506: Canister bkyz2-fmaaa-aaaaa-qaaaq-cai did not produce a response, error code Some("IC0506")
</code></pre>
<p>or this:</p>
<pre><code>2024-04-17T15:01:39.194377Z  WARN icx_proxy_dev::proxy::agent: Replica Error
2024-04-17T15:01:39.194565Z ERROR tower_http::trace::on_failure: response failed classification=Status code: 502 Bad Gateway latency=61 ms
</code></pre>
<p>it most likely means that your canister has thrown an error and halted execution for that call. First check the replica's logs for any errors messages. If there are no useful error messages, use <a href="#consolelog-and-trycatch">console.log and try/catch</a> liberally to track down the source of the error and to reveal more information about the error.</p>
<p>Don't be surprised if you need to <code>console.log</code> after each of your program's statements (including dependencies found in <code>node_modules</code>) to find out where the error is coming from. And don't be surprised if you need to use <code>try/catch</code> with a <code>console.log</code> of the catch error argument to reveal useful error messaging.</p>
<h2 id="no-error-message"><a class="header" href="#no-error-message">No error message</a></h2>
<p>You might find yourself in a situation where an error is reported without a useful message like this:</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="utf-8"&gt;
&lt;title&gt;Error&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;pre&gt; &amp;nbsp; &amp;nbsp;at &amp;lt;anonymous&amp;gt; (.azle/main.js:110643)&lt;br&gt; &amp;nbsp; &amp;nbsp;at handle (.azle/main.js:73283)&lt;br&gt; &amp;nbsp; &amp;nbsp;at next (.azle/main.js:73452)&lt;br&gt; &amp;nbsp; &amp;nbsp;at dispatch (.azle/main.js:73432)&lt;br&gt; &amp;nbsp; &amp;nbsp;at handle (.azle/main.js:73283)&lt;br&gt; &amp;nbsp; &amp;nbsp;at &amp;lt;anonymous&amp;gt; (.azle/main.js:73655)&lt;br&gt; &amp;nbsp; &amp;nbsp;at process_params (.azle/main.js:73692)&lt;br&gt; &amp;nbsp; &amp;nbsp;at next (.azle/main.js:73660)&lt;br&gt; &amp;nbsp; &amp;nbsp;at expressInit (.azle/main.js:73910)&lt;br&gt; &amp;nbsp; &amp;nbsp;at handle (.azle/main.js:73283)&lt;br&gt; &amp;nbsp; &amp;nbsp;at trim_prefix (.azle/main.js:73684)&lt;br&gt; &amp;nbsp; &amp;nbsp;at &amp;lt;anonymous&amp;gt; (.azle/main.js:73657)&lt;br&gt; &amp;nbsp; &amp;nbsp;at process_params (.azle/main.js:73692)&lt;br&gt; &amp;nbsp; &amp;nbsp;at next (.azle/main.js:73660)&lt;br&gt; &amp;nbsp; &amp;nbsp;at query3 (.azle/main.js:73938)&lt;br&gt; &amp;nbsp; &amp;nbsp;at handle (.azle/main.js:73283)&lt;br&gt; &amp;nbsp; &amp;nbsp;at trim_prefix (.azle/main.js:73684)&lt;br&gt; &amp;nbsp; &amp;nbsp;at &amp;lt;anonymous&amp;gt; (.azle/main.js:73657)&lt;br&gt; &amp;nbsp; &amp;nbsp;at process_params (.azle/main.js:73692)&lt;br&gt; &amp;nbsp; &amp;nbsp;at next (.azle/main.js:73660)&lt;br&gt; &amp;nbsp; &amp;nbsp;at handle (.azle/main.js:73587)&lt;br&gt; &amp;nbsp; &amp;nbsp;at handle (.azle/main.js:76233)&lt;br&gt; &amp;nbsp; &amp;nbsp;at app2 (.azle/main.js:78091)&lt;br&gt; &amp;nbsp; &amp;nbsp;at call (native)&lt;br&gt; &amp;nbsp; &amp;nbsp;at emitTwo (.azle/main.js:9782)&lt;br&gt; &amp;nbsp; &amp;nbsp;at emit2 (.azle/main.js:10023)&lt;br&gt; &amp;nbsp; &amp;nbsp;at httpHandler (.azle/main.js:87618)&lt;br&gt;&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>or like this:</p>
<pre><code>2024-04-17 14:35:30.433501980 UTC: [Canister bkyz2-fmaaa-aaaaa-qaaaq-cai] "    at &lt;anonymous&gt; (.azle/main.js:110643)\n    at handle (.azle/main.js:73283)\n    at next (.azle/main.js:73452)\n    at dispatch (.azle/main.js:73432)\n    at handle (.azle/main.js:73283)\n    at &lt;anonymous&gt; (.azle/main.js:73655)\n    at process_params (.azle/main.js:73692)\n    at next (.azle/main.js:73660)\n    at expressInit (.azle/main.js:73910)\n    at handle (.azle/main.js:73283)\n    at trim_prefix (.azle/main.js:73684)\n    at &lt;anonymous&gt; (.azle/main.js:73657)\n    at process_params (.azle/main.js:73692)\n    at next (.azle/main.js:73660)\n    at query3 (.azle/main.js:73938)\n    at handle (.azle/main.js:73283)\n    at trim_prefix (.azle/main.js:73684)\n    at &lt;anonymous&gt; (.azle/main.js:73657)\n    at process_params (.azle/main.js:73692)\n    at next (.azle/main.js:73660)\n    at handle (.azle/main.js:73587)\n    at handle (.azle/main.js:76233)\n    at app2 (.azle/main.js:78091)\n    at call (native)\n    at emitTwo (.azle/main.js:9782)\n    at emit2 (.azle/main.js:10023)\n    at httpHandler (.azle/main.js:87618)\n"
2024-04-17T14:35:31.983590Z ERROR tower_http::trace::on_failure: response failed classification=Status code: 500 Internal Server Error latency=101 ms
2024-04-17 14:36:34.652587412 UTC: [Canister bkyz2-fmaaa-aaaaa-qaaaq-cai] "    at &lt;anonymous&gt; (.azle/main.js:110643)\n    at handle (.azle/main.js:73283)\n    at next (.azle/main.js:73452)\n    at dispatch (.azle/main.js:73432)\n    at handle (.azle/main.js:73283)\n    at &lt;anonymous&gt; (.azle/main.js:73655)\n    at process_params (.azle/main.js:73692)\n    at next (.azle/main.js:73660)\n    at expressInit (.azle/main.js:73910)\n    at handle (.azle/main.js:73283)\n    at trim_prefix (.azle/main.js:73684)\n    at &lt;anonymous&gt; (.azle/main.js:73657)\n    at process_params (.azle/main.js:73692)\n    at next (.azle/main.js:73660)\n    at query3 (.azle/main.js:73938)\n    at handle (.azle/main.js:73283)\n    at trim_prefix (.azle/main.js:73684)\n    at &lt;anonymous&gt; (.azle/main.js:73657)\n    at process_params (.azle/main.js:73692)\n    at next (.azle/main.js:73660)\n    at handle (.azle/main.js:73587)\n    at handle (.azle/main.js:76233)\n    at app2 (.azle/main.js:78091)\n    at call (native)\n    at emitTwo (.azle/main.js:9782)\n    at emit2 (.azle/main.js:10023)\n    at httpHandler (.azle/main.js:87618)\n"
</code></pre>
<p>In these situations you might be able to use <code>try/catch</code> with a <code>console.log</code> of the catch error argument to reveal the underlying error message.</p>
<p>For example, this code without a <code>try/catch</code> will log errors without the message <code>This is the error text</code>:</p>
<pre><code class="language-typescript">import express from 'express';

const app = express();

app.get('/hello-world', (_req, res) =&gt; {
    throw new Error('This is the error text');
    res.send('Hello World!');
});

app.listen();
</code></pre>
<p>You can get the message to print in the replica terminal like this:</p>
<pre><code class="language-typescript">import express from 'express';

const app = express();

app.get('/hello-world', (_req, res) =&gt; {
    try {
        throw new Error('This is the error text');
        res.send('Hello World!');
    } catch (error) {
        console.log(error);
    }
});

app.listen();
</code></pre>
<h2 id="final-compiled-and-bundled-javascript"><a class="header" href="#final-compiled-and-bundled-javascript">Final Compiled and Bundled JavaScript</a></h2>
<p>Azle compiles and bundles your TypeScript/JavaScript into a final JavaScript file to be included and executed inside of your canister. Inspecting this final JavaScript code may help you to debug your application.</p>
<p>When you see something like <code>(.azle/main.js:110643)</code> in your error stack traces, it is a reference to the final compiled and bundled JavaScript file that is actually deployed with and executed by the canister. The right-hand side of <code>.azle/main.js</code> e.g. <code>:110643</code> is the line number in that file.</p>
<p>You can find the file at <code>[project_name]/.azle/[canister_name]/canister/src/main.js</code>. If you have the <code>AZLE_AUTORELOAD</code> environment variable set to <code>true</code> then you should instead look at <code>[project_name]/.azle/[canister_name]/canister/src/main_reloaded.js</code></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="databases.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="limitations.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="databases.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="limitations.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
